bash << 'EOF'
set -e

echo "This script will remove user-installed Python 3 (Homebrew + python.org),"
echo "but will NOT touch macOS's built-in system Python."
echo
read -p "Type YES to continue: " answer
if [ "$answer" != "YES" ]; then
  echo "Aborting. No changes made."
  exit 1
fi

echo "---- Step 1: Uninstall Homebrew Python (if Homebrew exists) ----"
if command -v brew >/dev/null 2>&1; then
  echo "Homebrew found, trying to uninstall python formulae..."
  brew uninstall --force python python@3.14 python@3.13 python@3.12 python@3.11 python@3.10 2>/dev/null || true
else
  echo "Homebrew not found, skipping Homebrew Python removal."
fi

echo
echo "---- Step 2: Remove python.org framework installs (3.x) ----"
if [ -d "/Library/Frameworks/Python.framework/Versions" ]; then
  echo "Found /Library/Frameworks/Python.framework/Versions"
  echo "Removing all Python 3.x versions installed there (you will be asked for your password)..."
  sudo rm -rf /Library/Frameworks/Python.framework/Versions/3.*
else
  echo "No python.org framework directory found, skipping."
fi

echo
echo "---- Step 3: Remove common python3/pip3 symlinks ----"
for dir in /usr/local/bin /opt/homebrew/bin; do
  if [ -d "$dir" ]; then
    echo "Cleaning symlinks in $dir ..."
    cd "$dir"
    for f in python3 python3.* pip3 pip3.* idle3 idle3.*; do
      if [ -L "$f" ]; then
        echo "  Removing symlink: $dir/$f"
        rm "$f"
      fi
    done
  fi
done

echo
echo "Cleanup complete."
echo "User-installed Python 3 should now be removed."
echo "You can now download and install Python 3.10 fresh from https://www.python.org/downloads/macos/"

EOF
